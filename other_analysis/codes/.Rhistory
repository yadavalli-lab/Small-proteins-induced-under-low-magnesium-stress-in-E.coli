# Prevent printing of warnings and such in the HTML
knitr::opts_chunk$set(warning = FALSE, message = FALSE, fig.align = "center", eval = FALSE)
library(tidyverse)
#load the data
promoter_reporter <- read_csv("~/Library/CloudStorage/Box-Box/github/Small-proteins-induced-under-low-magnesium-stress-in-E.coli/other_analysis/dataframe/promoter_reporter.csv")
#prepare the dataframe in the order we want to present
promoter_reporter$protein <- factor(promoter_reporter$protein, levels = c("mgrB", "mgtS-mgtT", "proP-pmrR","pmrR", "ymiA-yciX-ymiC", "ymiC",  "yoaI", "yobF", "yddY", "yriA-yriB", "yadX-clcA-yadW", "yadW","ykgS",  "asr-ydgU", "ydgU", "yqhI",  "dinQ"))
promoter_reporter$empty_vector <- factor(promoter_reporter$empty_vector, levels= c("Psmall protein",  "Pempty vector"))
promoter_reporter$strain <- factor(promoter_reporter$strain, levels= c("wild_type",  "mutant"))
plot_others <- promoter_reporter %>%
filter(protein != "mgrB") %>%
group_by(time, protein, strain, empty_vector) %>%
summarise(mean.val = mean(`yfp:cfp`), sd.val = sd(`yfp:cfp`), sem.val = sd.val / sqrt(n())) %>%
ungroup() %>%
ggplot(aes(x = time, y = mean.val, color = empty_vector, linetype = strain)) +
geom_smooth(aes(linetype = strain), size = 0.5, method = "loess", se = FALSE) +
geom_errorbar(aes(ymin = mean.val - sd.val, ymax = mean.val + sd.val),linetype = "solid", width = 0.2) +
facet_wrap(~protein, ncol = 4) +
scale_x_continuous(breaks = c(2, 6, 10, 14, 18, 22), expand = c(0.01, 0.01)) +
scale_color_manual(values = c("Pempty vector" = "#636363", "Psmall protein" = "#de2d26")) +
labs(x = "Time (Hours)", y = "YFP:CFP (a.u.)") +
theme(text = element_text(size = 18, family = "Arial"),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
axis.text.x = element_text(angle = 60, hjust = 1)) +
theme(legend.position = "none")
plot_others
promoter_reporter %>%
group_by(time, protein, strain, empty_vector) %>%
summarise(mean.val = mean(`yfp:cfp`), sd.val = sd(`yfp:cfp`), sem.val = sd.val / sqrt(n())) %>%
ungroup() %>%
ggplot(aes(x = time, y = mean.val, color = empty_vector, linetype = strain)) +
geom_smooth(aes(linetype = strain), size = 0.5, method = "loess", se = FALSE) +
geom_errorbar(aes(ymin = mean.val - sd.val, ymax = mean.val + sd.val),linetype = "solid", width = 0.2) +
facet_wrap(~protein, ncol = 4) +
scale_x_continuous(breaks = c(2, 6, 10, 14, 18, 22), expand = c(0.01, 0.01)) +
scale_y_continuous(limits = c(0.05, 0.35))+
scale_color_manual(values = c("Pempty vector" = "#636363", "Psmall protein" = "#de2d26")) +
labs(x = "Time (Hours)", y = "YFP:CFP (a.u.)") +
theme(text = element_text(size = 18, family = "Arial"),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
axis.text.x = element_text(angle = 60, hjust = 1)) +
theme(legend.position = "none")
plot_others <- promoter_reporter %>%
filter(protein != "mgrB") %>%
group_by(time, protein, strain, empty_vector) %>%
summarise(mean.val = mean(`yfp:cfp`), sd.val = sd(`yfp:cfp`), sem.val = sd.val / sqrt(n())) %>%
ungroup() %>%
ggplot(aes(x = time, y = mean.val, color = empty_vector, linetype = strain)) +
geom_smooth(aes(linetype = strain), size = 0.5, method = "loess", se = FALSE) +
geom_errorbar(aes(ymin = mean.val - sd.val, ymax = mean.val + sd.val),linetype = "solid", width = 0.2) +
facet_wrap(~protein, ncol = 4) +
scale_x_continuous(breaks = c(2, 6, 10, 14, 18, 22), expand = c(0.01, 0.01)) +
scale_color_manual(values = c("Pempty vector" = "#636363", "Psmall protein" = "#de2d26")) +
labs(x = "Time (Hours)", y = "YFP:CFP (a.u.)") +
theme(text = element_text(size = 18, family = "Arial"),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
axis.text.x = element_text(angle = 60, hjust = 1)) +
theme(legend.position = "none")
ggsave(last_plot(), filename = "~/Library/CloudStorage/Box-Box/github/Small-proteins-induced-under-low-magnesium-stress-in-E.coli/figures/Fig3B-other_proteins_promoter_reporter.png", width = 12, height = 12, units = "in", dpi = 600)
yoai_phosphate <- read_csv("~/Library/CloudStorage/Box-Box/github/Small-proteins-induced-under-low-magnesium-stress-in-E.coli/other_analysis/dataframe/yoaI_phosphate2.csv")
yoai_phosphate$strain <- factor(yoai_phosphate$strain, levels = c("pYoaI", "Empty_vector"))
yoai_phosphate$stress <- factor(yoai_phosphate$stress, levels = c("No_stress", "stress"), labels = c("No stress", "Low phosphate"))
yoai_phosphate %>%
filter(!mutant=="ΔphoQ") %>%
group_by(time, strain, stress, mutant) %>%
summarise(mean.val = mean(`yfp:cfp`), sd.val = sd(`yfp:cfp`), sem.val = sd.val / sqrt(n())) %>%  # Change sem.val to sd.val
ungroup() %>%
ggplot(aes(x = time, y = mean.val, color=strain)) +
#geom_line(aes(linetype = strain), size = 1) +
geom_errorbar(aes(ymin = mean.val - sem.val, ymax = mean.val + sem.val), width = 0.2) +
facet_grid(stress~mutant) +
geom_smooth(method = "loess", se = FALSE) +
scale_x_continuous(breaks = seq(0,21,3)) +
scale_y_continuous(limits = c(0.05, 0.2))+
#scale_y_continuous(trans = "log2") +
scale_color_manual(values = c("#de2d26", "#636363"), labels = c("pYoaI", "pEmpty vector")) +
labs(x = "Time (Hours)", y = expression("P"["yoaI"]~transcription~"\nYFP:CFP (a.u.)"),
color = NULL) +
theme(legend.position = "bottom",
text = element_text(size = 13, family = "Arial"),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
axis.text.x = element_text(angle = 60, hjust = 1))+
annotation_logticks(sides = "l")
yoai_phosphate %>%
filter(mutant=="ΔphoQ") %>%
group_by(time, strain, stress) %>%
summarise(mean.val = mean(`yfp:cfp`), sd.val = sd(`yfp:cfp`), sem.val = sd.val / sqrt(n())) %>%  # Change sem.val to sd.val
ungroup() %>%
ggplot(aes(x = time, y = mean.val, color=strain)) +
#geom_line(aes(linetype = strain), size = 1) +
geom_errorbar(aes(ymin = mean.val - sem.val, ymax = mean.val + sem.val), width = 0.2) +
geom_smooth(method = "loess", se = FALSE) +
scale_x_continuous(breaks = seq(0,21,3)) +
#scale_y_continuous(trans = "log2") +
facet_grid(stress~.)+
scale_color_manual(values = c("#de2d26", "#636363"),  labels = c("pYoaI", "pEmpty vector")) +
labs(x = "Time (Hours)", y = expression("P"["yoaI"]~transcription~"\nYFP:CFP (a.u.)"),
color = NULL) +
theme(legend.position = "bottom",
text = element_text(size = 13, family = "Arial"),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
axis.text.x = element_text(angle = 60, hjust = 1))
ggsave(last_plot(), filename = "~/Library/CloudStorage/Box-Box/github/Small-proteins-induced-under-low-magnesium-stress-in-E.coli/figures/Fig4B.png", width = 3, height = 3, units = "in", dpi = 600)
del_updated2 <- read_csv("~/Library/CloudStorage/Box-Box/github/Small-proteins-induced-under-low-magnesium-stress-in-E.coli/other_analysis/dataframe/all_strains_repeat_080124.csv")
del_updated2 <- del_updated2 %>%
mutate(strain = paste0("∆", strain)) %>% # Add ∆ to the strain column
dplyr::select(where(~ !all(is.na(.)))) # Remove columns where all values are NA
del_updated2$strain <- factor(del_updated2$strain, levels = c("∆mgtS", "∆mgrB", "∆pmrR", "∆mgtT", "∆ymiC", "∆ymiA", "∆yoaI", "∆yobF", "∆yddY", "∆yriAB", "∆yadX", "∆ykgS", "∆ydgU", "∆yqhI", "∆yadW", "∆dinQ"))
del_updated2$wild_type <- factor(del_updated2$wild_type, levels= c("yes",  "no"))
del_updated2%>%
filter(time != 0) %>%
group_by(time, strain, wild_type) %>%
summarise(mean.val = mean(OD), sem.val = sd(OD) / sqrt(n())) %>%
ungroup() %>%
ggplot(aes(x = time, y = mean.val, color = wild_type)) +
geom_point(size = 0.5) +
geom_line() +
geom_errorbar(aes(ymin = mean.val - sem.val, ymax = mean.val + sem.val),
width = 0.4, size= 0.4, linetype = "solid", position = position_dodge(0.3)) +
facet_wrap(~strain, ncol = 5) +
scale_x_continuous() +
scale_y_continuous(trans = "log2", limits = c(0.125, 1.25)) +
scale_color_manual(values = c("#636363","#de2d26"),
labels = expression(wild~type, Delta*italic("small protein"))) +
labs(x = "Time (Hours)", y = expression(log[2]("OD"[600]) * ("a.u.")),
color = NULL) +
theme(text = element_text(size = 16, family = "Arial"),
panel.background = element_blank(),
axis.line = element_line(color = "black"),
axis.text.x = element_text(angle = 60, hjust = 1)) +
annotation_logticks(sides = "l")+
theme(legend.position = "bottom")
ggsave(plot = last_plot(),filename = "~/Library/CloudStorage/Box-Box/github/Small-proteins-induced-under-low-magnesium-stress-in-E.coli/figures/Fig5A.png", dpi = 600, width = 8, height = 7.2)
